{
  "command": "cisco_ios_show_vrrp_brief",
  "source": "ntc",
  "status": "failed_validation",
  "match_ratio": null,
  "textfsm_rows": 5,
  "ttp_rows": 0,
  "ttp_template": "<group name=\"interface_group_preempt_time_state_master_ip_address_virtual_ip_address\">\n{{INTERFACE}} {{GROUP}} {{PRIORIT{{PREEMPT}}}} {{TIME}} Y {{STATE | ORPHRASE}} {{MASTER_IP_ADDRESS | re(\"\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+\")}} {{VIRTUAL_IP_ADDRESS | ORPHRASE}} \n</group>",
  "error": "TTP template produced 0 rows",
  "textfsm_parsed": [
    {
      "INTERFACE": "Fa0/1",
      "GROUP": "1",
      "PRIORITY": "110",
      "TIME": "3570",
      "PREEMPT": "Y",
      "STATE": "Master",
      "MASTER_IP_ADDRESS": "192.168.88.2",
      "VIRTUAL_IP_ADDRESS": "192.168.88.1"
    },
    {
      "INTERFACE": "Fa0/1.2",
      "GROUP": "2",
      "PRIORITY": "110",
      "TIME": "3570",
      "PREEMPT": "Y",
      "STATE": "Master",
      "MASTER_IP_ADDRESS": "10.0.2.2",
      "VIRTUAL_IP_ADDRESS": "10.0.2.1"
    },
    {
      "INTERFACE": "Fa0/1.3",
      "GROUP": "3",
      "PRIORITY": "110",
      "TIME": "3570",
      "PREEMPT": "Y",
      "STATE": "Backup",
      "MASTER_IP_ADDRESS": "10.0.3.3",
      "VIRTUAL_IP_ADDRESS": "10.0.3.1"
    },
    {
      "INTERFACE": "Fa0/1.4",
      "GROUP": "4",
      "PRIORITY": "100",
      "TIME": "3609",
      "PREEMPT": "Y",
      "STATE": "Init",
      "MASTER_IP_ADDRESS": "10.0.4.3",
      "VIRTUAL_IP_ADDRESS": "10.0.4.1"
    },
    {
      "INTERFACE": "Fa0/1.5",
      "GROUP": "5",
      "PRIORITY": "90",
      "TIME": "3570",
      "PREEMPT": "Y",
      "STATE": "Backup",
      "MASTER_IP_ADDRESS": "10.0.5.3",
      "VIRTUAL_IP_ADDRESS": "10.0.5.1"
    }
  ],
  "ttp_parsed": [
    {}
  ],
  "cli_content": "Interface          Grp Pri Time  Own Pre State   Master addr     Group addr\nFa0/1              1   110 3570       Y  Master  192.168.88.2    192.168.88.1   \nFa0/1.2            2   110 3570       Y  Master  10.0.2.2        10.0.2.1       \nFa0/1.3            3   110 3570       Y  Backup  10.0.3.3        10.0.3.1       \nFa0/1.4            4   100 3609       Y  Init    10.0.4.3        10.0.4.1       \nFa0/1.5            5   90  3570       Y  Backup  10.0.5.3        10.0.5.1       \n\n",
  "textfsm_template": "Value INTERFACE (\\S+)\nValue GROUP (\\d+)\nValue ADDR_FAMILY (\\S+)\nValue PRIORITY (\\d+)\nValue TIME (\\d+)\nValue OWN (.?)\nValue PREEMPT (.)\nValue STATE (\\w+)\nValue MASTER_IP_ADDRESS ([a-fA-F\\d\\.\\:]+)\nValue VIRTUAL_IP_ADDRESS ([a-fA-F\\d\\.\\:]+)\n\nStart\n  ^Interface\\s+Grp\\s+Pri\\s+Time\\s+Own\\s+Pre\\s+State\\s+Master addr\\s+Group addr\\s*$$ -> Vrrp\n  ^\\s*Interface\\s+Grp\\s+A-F\\s+Pri\\s+Time\\s+Own\\s+Pre\\s+State\\s+Master addr\\/Group addr\\s*$$ -> Vrrpv3\n  # Capture time-stamp if vty line has command time-stamping turned on\n  ^Load\\s+for\\s+\n  ^Time\\s+source\\s+is\n\nVrrp\n  # VRRP Legacy (VRRPv2 for IPv4)\n  ^${INTERFACE}\\s+${GROUP}\\s*${PRIORITY}\\s+${TIME}\\s+${OWN}\\s+${PREEMPT}\\s+${STATE}\\s+${MASTER_IP_ADDRESS}\\s+${VIRTUAL_IP_ADDRESS} -> Record\n  ^${INTERFACE}\\s*$$\n  ^\\s*${GROUP}\\s+${PRIORITY}\\s+${TIME}\\s+${OWN}\\s+${PREEMPT}\\s+${STATE}\\s+${MASTER_IP_ADDRESS}\\s+${VIRTUAL_IP_ADDRESS} -> Record\n  ^\\s*$$\n  ^. -> Error\n\nVrrpv3\n  # VRRP Unified (VRRPv3 for IPv4 and IPv6)\n  # - ignoring the \"local\" designation since we can use the STATE value to determine who the master is\n  ^\\s*${INTERFACE}\\s+${GROUP}\\s+${ADDR_FAMILY}\\s+${PRIORITY}\\s+${TIME}\\s+${OWN}\\s+${PREEMPT}\\s+${STATE}\\s+${MASTER_IP_ADDRESS}\\(local\\)\\s+${VIRTUAL_IP_ADDRESS} -> Record\n  ^\\s*${INTERFACE}\\s+${GROUP}\\s+${ADDR_FAMILY}\\s+${PRIORITY}\\s+${TIME}\\s+${OWN}\\s+${PREEMPT}\\s+${STATE}\\s+${MASTER_IP_ADDRESS}\\s+${VIRTUAL_IP_ADDRESS} -> Record\n  # rows that roll over to a second line\n  ^\\s*${INTERFACE}\\s*$$\n  ^\\s*${GROUP}\\s+${ADDR_FAMILY}\\s+${PRIORITY}\\s+${TIME}\\s+${OWN}\\s+${PREEMPT}\\s+${STATE}\\s+${MASTER_IP_ADDRESS}\\(local\\)\\s+${VIRTUAL_IP_ADDRESS} -> Record\n  ^\\s*${INTERFACE}\\s*$$\n  ^\\s*${GROUP}\\s+${ADDR_FAMILY}\\s+${PRIORITY}\\s+${TIME}\\s+${OWN}\\s+${PREEMPT}\\s+${STATE}\\s+${MASTER_IP_ADDRESS}\\s+${VIRTUAL_IP_ADDRESS} -> Record\n  ^\\s*$$\n  ^. -> Error\n"
}